(function(e,r,t){var i,n=Date.now(),c={},f={},a={},o={},l={},h=".js",u=function(e){return o[e]},s=function(){},p=function(r,e,t){if(c[r]&&!k(c[r]))return c[r];var n=v(r)||h,i=l[n];switch(i&&(e=i(r,e)),n){case h:var a,u={exports:{}},o={},s=e.call(t?{}:o,u.exports,j,u,p,function(e){return a=j(e)},N)||u.exports;return a&&(s=w(s,a)),"function"==typeof s&&(s.extend=O),o.load&&o.load(s),o.update&&(f[r]=[o.update,s]),r?c[r]=A(c[r],s):s;case".json":try{return c[r]=JSON.parse(e)}catch(e){return console.error(r,e.message)}default:return c[r]=e}},d={run:s,inherit:s,reload:s,parse:s,define:p,import:s,export:s,env:u,ajax:s},g="undefined"==typeof requestAnimationFrame?function(e){return setTimeout(e,100)}:requestAnimationFrame,v=function(e){if(!e)return null;var r=e.lastIndexOf(".");return-1!==r&&-1===e.indexOf("/",r)?e.substr(r):null},y=function(r,t){if(!r.length)return t();m(r.shift(),function(e){if(e)return t(e);y(r,t)})},m=function(n,i){if(c[n]=c[n]||N.import(n),c[n])return i(null,c[n]);var e=n.indexOf("/"),r=~e?a[n.slice(0,e)]:0,t=r?n.slice(e+1):n;(r=r||a["~"]||"")instanceof Function?r(t,function(e,r){if(e)return i(e);S(n,r,i)}):N.ajax("get",r+t+(v(n)?"":h),null,null,function(e,r,t){if(4===r)return e?i(e):void S(n,t,i)})},b=function(e){return Object.defineProperties(Function("return arguments.callee.__proto__.apply(this,arguments)"),{name:{value:e},i:{value:n}})},k=function(e){return"function"==typeof e&&n===e.i},A=function(e,r){return e&&e!==r?(k(e)&&(e.prototype=r.prototype),e.__proto__=r,e):r},x=function(e){return k(e)?e.__proto__:e},O=function(e,r){return e?w(e,this,r):this},w=function(e,r,t){var n,i,a=x(e),u=x(r),o=typeof a,s=typeof u;switch(o){case"function":i=(n=a).prototype;break;case"object":if(o==s)return a.__proto__=u,a;n=function(){return u.apply(this,arguments)},i=a;break;default:return a}switch(Object.assign(n,u,x(t)),s){case"function":return n.prototype=Object.assign(Object.create(u.prototype),i,{constructor:u}),n;case"object":return n.prototype=Object.assign(Object.create(u),i),n;default:return a}},j=function(e,r){var t=c[e];return void 0===t?r?m(e,r):c[e]=b(e):(r&&setTimeout(r,0,null,t),t)},S=function(r,e,t){if(t=t||s,c[r])return t(null,c[r]);if(h!==(v(r)||h))return t(null,p(r,e));var n=[],i=function(r,e,t,n){n=n||d;var i=r?'"use strict";\n'+e+(o.live?"":"//# sourceURL="+r):e,a=function(e){return c[e]||t.push(e),c[e]};try{var u=Function("exports","require","module","define","inherit","pico",i)}catch(e){return console.error(r,e.message)}return u.call({},{},a,{},p,a,n),u}(r,e,n);r&&(c[r]=b(r)),y(n,function(e){if(e)return t(e);t(null,p(r,i))})},T=function(e){var r;for(var t in f)(r=f[t])&&r[0](r[1],e);g(T)},N=e[r]={run:function(e,r){var t;for(var n in N.ajax=e.ajax||N.ajax,a=e.paths||a,o=e.env||o,l=e.preprocessors||l,i=e.importRule,c)(t=l[v(n)||h])&&(c[n]=t(n,c[n]));(e.onLoad||function(){arguments[arguments.length-1]()})(function(){S(e.name||null,function(e){return e.substring(e.indexOf("{")+1,e.lastIndexOf("}"))}(r.toString()),function(e,r){if(e)return console.error(e);r&&r(),g(T)})})},reload:function(t,e,n){"function"==typeof e&&(n=e),n=n||s;var r=function(e,r){if(e)return n(e);n(null,c[t]=A(c[t],r))};delete c[t],n===e?m(t,r):S(t,e,r)},parse:S,define:p,import:function(r){if(Array.isArray(i)&&i.some(function(e){return e.match(r)}))return t(r)},export:j,env:u};p("pico/func",function(e,r,t,n,i,a){function o(e,r){for(var t,n=r[0],i=[],a=0;t=r[a];a++)i.push(t.toString());return{typeName:n.getTypeName(),functionName:n.getFunctionName(),methodName:n.getMethodName(),fileName:n.getFileName(),line:n.getLineNumber(),column:n.getColumnNumber(),evalOrigin:n.getEvalOrigin(),isTopLevel:n.isToplevel(),isEval:n.isEval(),isNative:n.isNative(),isConstructor:n.isConstructor(),trace:i}}return{reflect:function e(r,t){var n=Error.prepareStackTrace,i=Error.stackTraceLimit;Error.prepareStackTrace=o,Error.stackTraceLimit=t||1;var a=new Error;Error.captureStackTrace(a,r||e);var u=a.stack;return Error.stackTraceLimit=i,Error.prepareStackTrace=n,u}}}),p("pico/json",function(e,r,t,n,i,a){return{parse:function(t,n){return JSON.parse(t[0],function(e,r){switch(e[0]){case"$":if(n)return JSON.parse(t[r]);case"_":return t[r];default:return r}})},stringify:function(e,t){var n=[];return n.unshift(JSON.stringify(e,function(e,r){switch(e[0]){case"$":if(t)return n.push(JSON.stringify(r));case"_":return n.push(r);default:return r}})),n},path:function(e){var l=e;function h(e,r){return r<0?(e.length||0)+r:r}return function e(){if(!arguments.length)return l;var r=Array.isArray(l);switch(typeof arguments[0]){case"string":var t=arguments[0];switch(t){default:if(r){if(!l[0][t])break;l=l.map(function(e){return e[t]})}else{if(!l[t])break;l=l[t]}break;case"..":l=function e(r,t){if(r&&t&&"object"==typeof t){if(t[r])return t[r];for(var n,i,a=[],u=Object.keys(t),o=0;i=u[o];o++)(n=e(r,t[i]))&&(Array.isArray(n)?a.push.apply(a,n):a.push(n));return a.length?a:void 0}}(arguments[1],l)||l;break;case"*":if(r)break;l=Object.keys(l).map(function(e){return l[e]})}break;case"object":var n=arguments[0];if(!Array.isArray(n))break;l=n.map(function(e){return l[h(l,e)]});break;case"number":for(var i=h(l,arguments[0]),a=h(l,arguments[1])||l.length-1||0,u=arguments[2]||1,o=[],s=[],c=i;c<=a;c+=u)o.push(l[c]),s.push(c);l=o;break;case"function":var f=arguments[0];l=r?l.map(f):f(l)}return Array.isArray(l)&&(l=l.filter(function(e){return null!=e})),1===l.length&&(l=l.pop()),e}}}}),p("pico/obj",function(){var h=["object","function"],p=["constructor"],c=[!0,!1,1,0,null];function f(e,r,t){if(!Array.isArray(r))return l(e,r,t);if(e){for(var n,i,a=0;i=r[a];a++)if(t&&t.push({}),n=l(e,i,t&&t[a]))return[a,n].join(".")}else t&&Array.prototype.push.apply(t,r)}function l(e,r,t){if(Array.isArray(r))return f(e,r,t);for(var n,i,a,u,o=Object.keys(e),s=0;u=o[s];s++){if(n=e[u],null==(i=r[u])&&n.required)return u;switch(n.type||n){case"string":if(!i.charAt)return u;t&&(t[u]=i);break;case"number":if(i=parseFloat(i),!isFinite(i))return u;t&&(t[u]=i);break;case"boolean":if(!c.includes(i))return u;t&&(t[u]=!!i);break;case"object":if(!(i instanceof Object)||Array.isArray(i))return u;if(t&&(t[u]={}),n.spec){if(a=l(n.spec,i,t&&t[u]))return[u,a].join(".")}else t&&Object.assign(t[u],i);break;case"array":if(!(i instanceof Object&&Array.isArray(i)))return u;if(t&&(t[u]=[]),a=f(n.spec,i,t[u]))return[u,a].join(".");break;case"null":if(null!==i)return u;t&&(t[u]=null);break;default:return u}}}return{extend:function e(r,t,n){var i=h.indexOf(typeof r),a=h.indexOf(typeof t);if(1===i&&(i=h.indexOf(typeof r.__proto__)),1===a&&(a=h.indexOf(typeof t.__proto__)),!r||null===t||-1===a&&a===i)return void 0===t?r:t;if(1===a)return a===i&&(t.prototype=r),t;var u,o,s=(n=n||{}).tidy;if(Array.isArray(t))if(n.mergeArr){var c,f,l={};for(c=0,f=(r=r||[]).length;c<f;c++)void 0===(o=r[c])&&s||(l[o]=o);for(c=0,f=t.length;c<f;c++)void 0===(o=t[c])&&s||(l[o]=o);for(u in r=[],l)r.push(l[u])}else r=t;else for(u in r=r||{},t)o=t[u],~p.indexOf(u)||void 0===o&&s||(r[u]=e(r[u],o,n));return r},extends:function(e,r,t){for(var n,i=this.extend,a=0;n=r[a];a++)e=i(e,n,t);return e},parseInts:function(e,r){for(var t=0,n=e.length;t<n;t++)e[t]=parseInt(e[t],r);return e},pluck:function(e,r){var t=[];if(e.length){var n,i,a,u,o,s={};for(a=0,u=e.length;a<u;a++)(n=e[a])&&void 0!==(i=n[r])&&(s[i]=i);for(o in s)t.push(s[o])}return t},dot:function e(r,t,n){if(!t||!t.length)return r;var i,a=t.shift();if(Array.isArray(a))for(var u,o=0;(u=a[o])&&!(i=r[u]);o++);else i=r[a];return i?e(i,t,n):n},validate:l}}),p("pico/str",function(){var e=Math.random;function u(e){var r=e.search(/[#:%][a-zA-Z]/);switch(r){case-1:case 0:return e}return[e.substring(0,r),e.substr(r)]}function a(t,n,i){if(!t.length)return i(null,n);!function e(r,t,n,i){var a=r.indexOf("/",t);if(-1===a)return n.push(u(r.substring(t))),i(null,n);n.push(u(r.substring(t,a))),e(r,a+1,n,i)}(t.shift(),0,[],function(e,r){if(e)return i(e);n.push(r),a(t,n,i)})}function o(e,r,t,n,i){switch(e[0]){default:return e===r;case"%":i[e.substr(1)]=parseFloat(r);break;case":":i[e.substr(1)]=r;break;case"#":i[e.substr(1)]=t.slice(n).join("/")}return!0}function s(e,r,t){if(e.length<r.length)return!1;for(var n,i,a=0,u=r.length;a<u;a++)if(i=r[a],n=e[a],Array.isArray(i)){if(0!==n.indexOf(i[0]))return!1;if(!o(i[1],n.substr(i[0].length),e,a,t))return!1}else if(!o(i,n,e,a,t))return!1;return e.splice(0,u),!0}function c(e,r,t,n,i,a){if(r.length<=t)return e;var u=r[t++];if(!u.charAt)return c(c(e+i,u,0,n,"",a),r,t,n,i,a);if(1<u.length)switch(u.charAt(0)){case"%":case":":case"#":if(!(u=n[u.slice(1)]))return a?"":e}return c(e+=i+u,r,t,n,i,a)}return{codec:function(e,r){for(var t,n=0,i="";t=r.charCodeAt(n);n++)i+=String.fromCharCode(t^e);return i},hash:function(e){for(var r,t=0,n=0;r=e.charCodeAt(t);t++)n=(n<<3)-n+r|0;return n},rand:function(){return e().toString(36).substr(2)},pad:function(e,r,t){return this.tab(e,r,t)+e},tab:function(e,r,t){var n=r-String(e).length+1;return Array(0<n?n:0).join(t||"0")},template:function(e){for(var r,t=/<%(.+?)%>/g,n=/(^( )?(var|if|for|else|switch|case|break|{|}|;))(.*)?/g,i="var r=[];\n",a=0,u=function(e,r){return i+=r?e.match(n)?e+"\n":"r.push("+e+");\n":""!==e?'r.push("'+e.replace(/"/g,'\\"')+'");\n':"",u};r=t.exec(e);)u(e.slice(a,r.index))(r[1],!0),a=r.index+r[0].length;return u(e.substr(a,e.length-a)),function(r){return function(e){return r(N,e)}}(new Function("pico","d",(i+'return r.join("");').replace(/[\r\t\n]/g," ")))},compileRest:function(e,t){return t=t||[],-1===e.search(/[|#:%][a-zA-Z]/)||a(e.split("|"),[e],function(e,r){if(e)throw e;t.push(r)}),t},execRest:function(e,r,t){for(var n,i,a,u=e.split("/"),o=0;n=r[o];o++)if(s(u,n[1],t)){for(i=2;(a=n[i])&&s(u,a,t);i++);return n[0]}return null},buildRest:function(e,r,t,n){for(var i,a,u=0;a=r[u];u++)if(e===a[0]){i=a;break}if(!i)return e;var o,s=c("",i[1],0,t,"/",!0);if(!s)return!1;for(u=2;o=i[u];u++)s=c(s,o,0,t,"/");return(n||1===s.indexOf("http"))&&(s=s.slice(1)),!~s.search(/[#%][a-zA-Z]/)&&s}}}),p("pico/time",function(){var a=Math.max,u=Math.min,y=Math.floor,o=Math.ceil,s=function(e,r){return(e-r)/864e5},c=function(e,r,t){var n=r?1:0,i=new Date(e.getFullYear()+(t||0),0,1),a=(7-i.getDay())%7+n,u=s(e,i);return a<u?o((u-a)/7):c(e,r,-1)},p=function(e,r,t){var n=e.split("/"),i=n[0];return"*"===i?n[0]=r:(i=parseInt(i),i=a(r,i),i=u(t,i),n[0]=i),1===n.length?n.push(0):n[1]=parseInt(n[1]),n},f=function(e,r,t){if("*"===e)return 0;for(var n,i,a,u,o,s,c,f=[],l=e.split(","),h=0;n=l[h];h++)if(a=n.split("-"),u=p(a[0],r,t),1!==a.length)if(o=p(a[1],r,t),i=u[0],s=o[0],c=o[1]||1,s<i)for(;s<=i;i-=c)f.push(i);else for(;i<=s;i+=c)f.push(i);else if(c=u[1])for(i=u[0];i<=t;i+=c)f.push(i);else f.push(u[0]);return f.sort(function(e,r){return e-r}),f},m=function(e,r,t){if(!r)return e;if(a.apply(Math,r.concat(e))===e)return e+(t-e)+u.apply(Math,r);for(var n=0,i=r.length;n<i;n++)if(r[n]>=e)return r[n];console.error("not suppose to be here",e,r,t)},b=function(e,r,t,n,i,a,u,o,s){if(3<r++)return s(0);var c=m(e.getMinutes(),t,60),f=m(e.getHours()+y(c/60),n,24),l=e.getDate(),h=e.getMonth(),p=e.getFullYear(),d=new Date(p,h,0).getDate();if(u){var g=e.getDay()+y(f/24);l+=m(g,u,7)-g}else l=m(l+y(f/24),i,d);if(h=m(h+1+y(l/d),a,12),e.getMonth()+1!==h)return b(new Date(p,h-1),r,t,n,i,a,u,o,s);if(p=m(p+y((h-1)/12),o,0),e.getFullYear()!==p)return b(new Date(p,h-1),r,t,n,i,a,u,o,s);var v=new Date(p,(h-1)%12).getTime();return v+=864e5*(l%d-1),v+=f%24*36e5,s(v+=c%60*6e4)};return{parse:function(e){var r=e.split(" ");if(r.length<6)return 0;var t=f(r[0],0,59);if(null==t)return 0;var n=f(r[1],0,23);if(null==n)return 0;var i=f(r[2],1,31);if(null==i)return 0;var a=f(r[3],1,12);if(null==a)return 0;var u=f(r[4],0,6);if(null==u)return 0;var o=f(r[5],1975,2075);return null==o?0:[t,n,i,a,u,o]},nearest:function(e,r,t,n,i,a,u){return u=u||Date.now(),b(new Date(u+9e4),0,e,r,t,n,i,a,function(e){return e})},daynum:s,weeknum:c,day:function(e,r){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),12,0,0)-e;return 0<=n&&n<=1296e5||n<=0&&-1296e5<n?t.getDate()===e.getDate()?"Today":e<t?"Yesterday":"Tomorrow":(r=r||"en-US",t.getFullYear()===e.getFullYear()&&c(t)===c(e)?e.toLocaleDateString(r,{weekday:"long"}):e.toLocaleDateString(r,{weekday:"short",month:"short",day:"numeric"}))}}}),p("pico/web",function(e,r,t,n,i,c){var p=r("pico/json"),d=Math.abs,a=Math.floor,u=Math.random,f=!0,o=function(e){e&&console.error(e)},g=function(e,r,t){e.append(r,t)},v=function(e,r,t){e[r]=t},y=function(i,a){a=a||o,c.ajax("get",i.url,null,null,function(e,r,t){if(4===r){if(e)return a(e);var n=parseInt(t);if(isNaN(n))return a("invalid timesync response");i.serverTime=n,i.serverTimeAtClient=Date.now(),a()}})},l=function(e,r,t,n){switch(e&&4===r&&y(n),r){case 2:n.head=null,n.currPT=1,n.resEndPos=0}if(t){var i,a=n.resEndPos,u=-1,o=n.delimiter,s=o.length,c=n.body;try{for(;-1!==(u=t.indexOf(o,a));){switch(n.currPT){case 1:n.head=JSON.parse(t.substring(a,u)),c.length=0,n.currPT=2;break;case 2:c.push(t.substring(a,u))}if((i=n.head)&&i.len===c.length){if(n.currPT=1,i.resId&&n.request("ack",{resId:i.resId}),!i.reqId)return void console.error("incomplete response header: "+JSON.stringify(i));if(n.cullAge&&n.cullAge<d(n.getServerTime()-i.date))return void console.error("invalid server time: "+JSON.stringify(i)+" "+d(n.getServerTime()-i.date));if(n.secretKey&&c.length){for(var f=CryptoJS.algo.HMAC.create(CryptoJS.algo.MD5,n.secretKey+i.date),l=0,h=c.length;l<h;l++)f.update(c[l]);if(i.key!==f.finalize().toString(CryptoJS.enc.Base64))return void console.error("invalid server key: "+JSON.stringify(i))}i.len&&(i.data=p.parse(c,!0)),n.inbox.push(i),n.head=null}a=u+s}}catch(e){console.error(e)}n.resEndPos=4===r?0:a}},m=function(e,r,t,n,i){n=n||"",i=i||"";for(var a,u,o,s,c=e instanceof FormData?g:v,f=r.baseURI,l=0,h=r.elements;s=h[l];l++)if(s.hasAttribute("name"))if("FILE"===(a=s.hasAttribute("type")?s.getAttribute("type").toUpperCase():"TEXT"))for(u=0,o=s.files.length;u<o;c(e,n+s.name,s.files[u++]));else("RADIO"!==a&&"CHECKBOX"!==a||s.checked)&&c(e,n+s.name,s.value);if(t)for(var p in t)c(e,i+p,t[p]);return f=f.substring(0,f.lastIndexOf("/")+1),r.action.substr(f.length)},s=function(e,r){e.url=r.url||e.url,e.secretKey=r.secretKey||e.secretKey,e.cullAge=r.cullAge||e.cullAge,e.delimiter=r.delimiter?JSON.stringify(r.delimiter):e.delimiter};function h(e){if(!e.url)return console.error("url is not set");s(this,Object.assign({cullAge:0,delimiter:["&"]},e)),this.reqId=1+a(1e3*u()),this.inbox=[],this.outbox=[],this.uploads=[],this.callbacks={},this.acks=[],this.reqs=[],this.resEndPos=0,this.head=null,this.body=[],this.currPT=1,this.serverTime=0,this.serverTimeAtClient=0}return h.prototype={beat:function(){if(this.inbox.length)for(var e,r,t,n=this.inbox,i=this.callbacks;t=n.pop();)(r=i[e=t.reqId])&&(delete i[e],r(t.error,t.data));if(f&&(this.uploads.length||this.outbox.length||this.acks.length)){var a=this.uploads,u=this.outbox,o=this.acks;if(a.length)c.ajax("post",this.url,a.shift(),null,l,this);else{var s=this.reqs=o.concat(u);o.length=u.length=0,c.ajax("post",this.url,s.join(this.delimiter)+this.delimiter,null,l,this)}}},reconnect:function(e,r){s(this,e),function(e){e.resEndPos=e.outbox.length=e.acks.length=0,e.currPT=1}(this),y(this,function(e){r(e,this)})},submit:function(e,r,t){if(!("undefined"!=typeof window&&e&&e instanceof HTMLFormElement))return console.error("No HTMLFormElement submitted");var n=0;t&&(n=this.reqId++,this.callbacks[n]=t);var i=new FormData;i.append("api",m(i,e,r,"data/","cred/")),i.append("reqId",n),this.uploads.push(i)},request:function(e,r,t,n){switch(arguments.length){case 2:r instanceof Function&&(n=r,r=t=void 0);break;case 3:t instanceof Function&&(n=t,t=void 0);break;case 4:break;default:return console.error("wrong request params!")}if("undefined"!=typeof window&&r instanceof HTMLFormElement){var i={};e=m(i,r),r=i}if(!e)return console.error("Missing api,  data["+JSON.stringify(r)+"]");var a=this.acks;if("ack"!==e&&(a=this.outbox).length){var u=a.shift();-1===u.indexOf(e)&&a.unshift(u)}var o=0;n&&(o=this.reqId++,this.callbacks[o]=n);var s=r?p.stringify(r,!0):[];if(s.unshift(JSON.stringify(t)),s.length&&this.secretKey){for(var c=this.getServerTime(),f=CryptoJS.algo.HMAC.create(CryptoJS.algo.MD5,this.secretKey+c),l=0,h=s.length;l<h;l++)f.update(s[l]);s.unshift(JSON.stringify({api:e,reqId:o,len:s.length,date:c,key:f.finalize().toString(CryptoJS.enc.Base64)}))}else s.unshift(JSON.stringify({api:e,reqId:o,len:s.length}));a.push(s.join(this.delimiter))},getServerTime:function(){return this.serverTime+(Date.now()-this.serverTimeAtClient)},test:function(e){y(this,e)}},{create:function(e,r){var t=new h(e);return y(t,function(e){r&&r(e,t)}),t},online:function(){f=!0},offline:function(){f=!1}}})}).apply(null,"object"==typeof module?[module,"exports",require]:[window,"pico"]);
//# sourceMappingURL=bin/pico.min.js.map